function r(a){var c=this;return this.c=a,this.tab=null,this.S=[],this.betFinishedFlag=!0,this.Sb=function(a){(a=arbHandler.F(a))&&(a.player1=a.player1.replace(/\{\(.*\)\}/g,""),a.player2=a.player2.replace(/\{\(.*\)\}/g,""),a.alerts=[],a.feedbacks=[],a.progress={},a.betPlaceProgress={},a.betPlaceProgress.active=!1,a.htmlID=null,a.betPage=null,a.betPageCheck=null,a.betBetslip=null,a.betBetslipCheck=null,a.progress.active=!0,a.progress.type="info",a.progress.percent=0,a.progress.finished=!1,a.progress.title=languages.selected.progress_startNavigation)},this.jc=function(a,d){d||(d=!1),!arbHandler.F(a)||0<=this.S.indexOf(a)||(d||this.Sb(a),this.S.push(a))},this.Za=function(){this.b("stop")},this.Tc=function(){if(!this.betFinishedFlag||!this.S.length)return!1;if(this.J=this.S.pop(),this.Sb(this.J),this.a=arbHandler.F(this.J)){if(this.betFinishedFlag=!1,this.a.progress.finished=!1,!_.isUndefined(c.a.customUrl)&&""!==c.a.customUrl){if("object"!=typeof c.a.pagelink){var a=c.a.pagelink.replace(c.c.bookieURL,c.a.customUrl);c.a.pagelink=a}c.c.bookieURL=w.mb(c.a.customUrl),c.a.customUrl=w.mb(c.a.customUrl),a=new URL(c.c.bookieURL).hostname,c.c.URLmatchstring=a,-1===_.findIndex(t.oa,a)&&t.oa.push(a)}return!0}return!1},this.$b=function(){this.Tc()&&this.b("start")},this.xa=function(){this.Ja=!1,this.a={},this.ab=this.H=this.$a=this.bb=0,this.Gb=this.sa=!1,this.betFinishedFlag=!0,this.S=[],this.D.parent=this,this.D.xa()},this.b=function(a){0===a.indexOf("betPlacer_")?this.D.b(a.replace("betPlacer_","")):(this.g=a,this.Ib=(new Date).getTime(),this.cb&&(clearTimeout(this.cb),this.cb=null),(1!=this.betFinishedFlag||"error"==a)&&("tabOpenedCompleted"!=a&&"tabReusedCompleted"!=a||0!=this.a.betfinderEnabled||(m.i("Navigation",this.g,languages.selected.error_betfinderDisabled,"",this.a),this.f(languages.selected.error_betfinderDisabled,null),this.b("error")),"stop"==a&&(m.i("Stop",this.g,languages.selected.error_betStopped,"",this.a),this.f(languages.selected.error_betStopped,null),this.b("error")),"start"==a?(this.Lc(),this.a.progress.percent=0,this.a.progress.title=languages.selected.progress_openTabpage,this.tc()):"openTab"==a?this.Oa(this.c.URLmatchstring,"tabOpened","tabReused"):"tabOpened"==a?(this.a.progress.percent=5,this.I("tabOpenedCompleted",this.c.mainPageLoadCounter)):"tabReused"==a?(this.a.progress.percent=5,this.ma(),this.I("tabReusedCompleted",0)):"tabOpenedCompleted"==a?(this.a.progress.percent=10,this.H=0,this.Q("DOMLoaded","mainopened")):"tabReusedCompleted"==a?(this.a.progress.percent=10,this.H=0,this.Q("DOMLoaded","mainreused")):"DOMLoaded"==a?(this.a.progress.percent=15,this.a.progress.title=languages.selected.progress_pageloadCompleted,this.b("checkLoggedIn")):"checkLoggedIn"==a?(this.r=!1,this.r||(this.a.progress.percent=20),this.la("loggedIn","navigateLogin")):"navigateLogin"==a?(this.r||(this.a.progress.percent=25),this.a.progress.title=languages.selected.progress_login,this.qd()):"navigateLogin2"==a?(this.r||(this.a.progress.percent=26),this.I("navigateLogin3",this.c.loginNavigationPageLoadCounter)):"navigateLogin3"==a?(this.r||(this.a.progress.percent=27),this.H=0,this.Q("login","beforelogin")):"login"==a?(this.r||(this.a.progress.percent=28),this.ld()):"login2"==a?(this.r||(this.a.progress.percent=29),this.I("login3",this.c.loginPageLoadCounter)):"login3"==a?(this.r||(this.a.progress.percent=30),this.H=0,this.Q("login4","login")):"login4"==a?(this.r||(this.a.progress.percent=30),this.r=!0,this.la("loggedIn","loginFailed")):"loginFailed"==a?(this.a.progress.percent=30,this.Sa(languages.selected.error_loginFailed),this.b("checkAreWeOnBetPage")):"loggedIn"==a?(this.a.progress.percent=35,this.a.progress.title=languages.selected.progress_loggedIn,this.b("navigateBalancePage")):"navigateBalancePage"==a?(this.a.progress.percent=36,this.a.progress.title=languages.selected.progress_getBalance,this.pd()):"navigateBalancePage2"==a?(this.a.progress.percent=37,this.I("navigateBalancePage3",this.c.balancePageLoadCounter)):"navigateBalancePage3"==a?(this.a.progress.percent=38,this.H=0,this.Q("getBalance","beforeBalance")):"getBalance"==a?(this.a.progress.percent=39,this.yb("checkLoginAgain")):"checkLoginAgain"==a?(this.a.progress.percent=40,this.a.progress.title=languages.selected.progress_login,this.r?this.b("checkAreWeOnBetPage"):this.la("checkAreWeOnBetPage","navigateLogin")):"checkAreWeOnBetPage"==a?(this.a.progress.percent=40,this.a.progress.title=languages.selected.progress_checkBetPage,this.kb("falseBetPage")):"falseBetPage"==a?(this.a.progress.percent=45,this.navigateBetPage("navigateBetPage")):"navigateBetPage"==a?(this.a.progress.percent=46,this.a.progress.title=languages.selected.progress_navigateBetPage,this.I("navigateBetPage2",this.c.betPageLoadCounter)):"navigateBetPage2"==a?(this.a.progress.percent=47,this.H=0,this.Q("navigateBetPage3","bet")):"navigateBetPage3"==a?(this.a.progress.percent=48,this.kb("navigateBetPage4")):"navigateBetPage4"==a?(this.a.progress.percent=49,c.xc()):"correctBetPage"==a?(this.a.progress.percent=50,this.a.progress.title=languages.selected.progress_getBetInfo,this.b("getBetData")):"getBetData"==a?(this.a.progress.percent=55,this.Uc()):"openBetSlip"==a?(this.a.progress.title=languages.selected.progress_addToBetslip,this.a.progress.percent=60,this.openBetSlip("clearBetSlip")):"clearBetSlip"==a?(this.a.progress.percent=65,this.yc()):"addBetSlip"==a?(this.a.progress.percent=70,this.kc()):"getMinMaxStake"==a?(this.a.progress.percent=75,this.$c()):"getBetSlipData"==a?(this.a.progress.title=languages.selected.progress_getInfoBetslip,this.a.progress.percent=80,this.ra("compareData")):"compareData"==a?(this.a.progress.percent=81,this.Ec()):"betsMatches"==a?(this.a.progress.percent=82,this.b("sendBetBack")):"sendBetBack"==a?(this.a.progress.percent=95,this.Od()):"finish"==a?(this.a.progress.title=languages.selected.progress_navigationFinished,this.a.progress.percent=100,this.a.progress.active=!1,"info"==this.a.progress.type&&(this.a.progress.type="success"),this.wb()):"injectionError"==a?(m.i("Navigation",this.g,"Cannot open "+this.a.bookieName,"",this.a),this.f(languages.selected.error_openBetPage+" "+this.a.bookieName,null),this.b("error")):"error"==a&&(this.a&&this.a.progress&&(this.a.progress.type="error",this.a.progress.active=!1),this.wb()),arbHandler.gb()))},this.xc=function(){m.i("Navigation",this.g,"Cannot open bet's page","",this.a),c.f(languages.selected.error_openBetPage,null)},this.tc=function(){null==this.c||this.c.error?(m.i("HandlerNotLoaded",this.g,"Cannot load handler: "+this.c.error,"",this.a),this.f(languages.selected.error_handlerNotLoaded,this.J)):this.b("openTab")},this.Od=function(){this.b("finish")},this.wb=function(){0==this.betFinishedFlag&&(this.betFinishedFlag=!0,this.a.progress.finished=!0,arbHandler.pc()),this.ub(),this.$b()},this.Oa=function(a,d,c){return q.Oa(this,a,d,c)},this.N=function(){return q.N(this)},this.vd=function(){return q.vd()},this.ma=function(){q.ma&&q.ma(this)},this.ee=function(){var a=(new Date).getTime();if(null!=this.Ib&&6e4<a-this.Ib){m.i("WatchDog",this.g,"Watchdog","",this.a),t.pb(this.c.bookieName);var d=this.J;setTimeout(function(){arbHandler.Ra(d)},1e3),this.ub()}},this.Lc=function(){var a=this;scriptLoader.scriptList.disableWatchdog||this.Aa||(this.Aa=setInterval(function(){a.ee()},500))},this.ub=function(){null!=this.Aa&&(clearInterval(this.Aa),this.Aa=null)},this.I=function(a,d){return q.I(this,a,d)},this.gc=function(a){if(!this.betFinishedFlag){var d=this;if(null==a&&(a=0),40==a)d.e({action:"reloadPage"},null);else if(a>60)return void this.f(languages.selected.error_loadPage,null);d.cb=setTimeout(function(){d.gc(++a)},1e3)}},this.Q=function(a,d){if(!this.betFinishedFlag){var c=this;this.e({action:"boolIsPageFinishedLoading",after:d},function(g){g&&1==g.retval?c.b(a):g&&g.retval.error?languages.selected[g.retval.error]?(m.i(g.retval.error,c.g,g.retval.error,"",c.a),c.f(languages.selected[g.retval.error],null)):(m.i("NavigationTimeout",c.g,"Cannot load page","",c.a),c.f(languages.selected.error_loadPage,null)):(c.H++,c.H>c.c.checkPageLoadedMaxCounter?(m.i("NavigationTimeout",c.g,"Cannot load page","",c.a),c.f(languages.selected.error_loadPage,null)):setTimeout(function(){c.Q(a,d)},c.c.checkPageLoadedInterval))},2e3)}},this.qd=function(){if(void 0!=this.c.navigateLoginPage&&this.a.userId&&this.a.password){var a=this;this.e({action:"navigateLoginPage"},function(d){d&&d.retval.script?a.e({action:"executeScript",code:d.retval.script},function(){a.b("navigateLogin2")}):d&&d.retval.url?q.Na(a,d,"navigateLogin2"):(m.i("Navigation",a.g,"Empty response","",a.a),a.f(languages.selected.error_navigation,null))})}else this.b("login")},this.navigateBetPage=function(a){var d=this;d.e({action:"navigateBetPage"},function(c){c&&c.retval.script?d.e({action:"executeScript",code:c.retval.script},function(){d.b(a)}):c&&c.retval.url?q.Na(d,c,a):(m.i("Navigation",d.g,"Empty response","",d.a),d.f(languages.selected.error_navigation,null))})},this.pd=function(){if(void 0==this.c.navigateBalancePage)this.b("navigateBalancePage2");else{var a=this;a.e({action:"navigateBalancePage"},function(d){d&&null==d.retval?a.b("navigateBalancePage2"):d&&d.retval.script?a.e({action:"executeScript",code:d.retval.script},function(){a.b("navigateBalancePage2")}):d&&d.retval.url?q.Na(a,d,"navigateBalancePage2"):(m.i("ParseBalance",a.g,"Cannot navigate to balance page.","",a.a),a.f(languages.selected.error_navigateBalancePage,null))})}},this.yb=function(a){var d=this;d.e({action:"getBalance",je:d.a.currency},function(c){if(c&&c.retval){var g=c.retval.currency,f=c.retval.currencyStr;if(null==g&&null!=f){var h=null;try{h=arbHandler.currentArb.arb.fxSetup.rates}catch(k){}if(!h)try{h=fx.rates}catch(p){}h&&h[f]&&(g=f)}null==g&&null!=f?(d.Sa(languages.selected.error_currencyNotSupported),f=f.toString().replace(/[0-9]/g,""),m.i("CurrencyString",d.g,f,"",d.a)):(d.a.balance=parseFloat(c.retval.balance),d.a.currency!=g&&u.n("changeCurrency",{currency:g,he:d.c.bookieName}),d.a.currency=g),d.b(a)}else m.i("ParseBalance",d.g,"Cannot get balance","",d.a),d.f(languages.selected.error_getBalance,null)})},this.ra=function(a){var d=this;d.e({action:"getBetSlipData",betID:d.a.htmlID},function(c){c&&c.retval.error||!c?(c||(c={retval:{}}),m.i("ParseBetslip",d.g,c.retval.error,c.retval.Z,d.a),d.f(languages.selected.error_parseBetslip,null)):(d.a.betBetslip=_.cloneDeep(c.retval.bet),d.a.betBetslipCheck=d.qb(c.retval.bet),d.b(a))})},this.Uc=function(){var a=this;a.e({action:"getBetData"},function(d){d&&d.retval.error||!d?(d||(d={retval:{}}),languages.selected[d.retval.error]?(m.i(d.retval.error,a.g,d.retval.error,d.retval.Z,a.a),a.f(languages.selected[d.retval.error],null)):(m.i("ParsePage",a.g,d.retval.error,d.retval.Z,a.a),a.f(languages.selected.error_parseBet,null))):(a.a.htmlID=_.cloneDeep(d.retval.betID),a.a.betPage=_.cloneDeep(d.retval.bet),a.a.betPageCheck=a.qb(d.retval.bet),a.b("openBetSlip"))})},this.be=function(a,d){"odd"===a&&(this.a.decimalOdd=d,arbHandler.currentArb.updatedActualPcnt||(arbHandler.currentArb.updatedActualPcnt=!0)),arbHandler.o()},this.Ec=function(){var a=w.Dc(this.a);if(null!=a){for(var d=w.Sc(a,this.a),c=0;c<d.length;c++)m.ja(d[c].title,d[c].message,d[c].type,this.J,this.c.bookieName),this.be(d[c].key,d[c].value);(a=w.Qc(a,this.a))&&m.Oc(a,this.a)}this.b("betsMatches")},this.qb=function(a){var c,d={};for(c in a){var g=!1;"number"==typeof this.a[c]?parseFloat(this.a[c])==parseFloat(a[c])&&(g=!0):this.a[c]&&a[c]&&w.K(this.a[c].toString())==w.K(a[c].toString())&&(g=!0),d[c]=g}return d},this.ld=function(){var a=this;this.a.userId&&this.a.password?a.e({action:"fillLoginForms",username:a.a.userId,password:a.a.password},function(c){c&&c.retval.error?(m.i("Login",a.g,"Cannot fill login information.","",a.a),a.b("loginFailed")):a.e({action:"clickLogin"},function(c){a.b(c&&1==c.retval?"login2":"loginFailed")})}):this.b("loginFailed")},this.la=function(a,c){var e=this;e.e({action:"isLoggedIn"},function(g){e.b(g&&1==g.retval?a:c)})},this.kc=function(){var a=this;a.e({action:"checkBetSlipAdded",betID:a.a.htmlID},function(c){c&&1==c.retval?a.b("getMinMaxStake"):a.e({action:"addBetSlip",betID:a.a.htmlID},function(c){c&&1==c.retval?(a.$a=0,a.W("getMinMaxStake")):(m.i("AddBetslip",a.g,"Cannot add bet to betslip with ID: "+a.a.htmlID,"",a.a),a.f(languages.selected.error_addToBetslip,null))})})},this.W=function(a){if(!this.betFinishedFlag){var c=this;c.e({action:"checkBetSlipAdded",betID:c.a.htmlID},function(e){e&&1==e.retval?c.b(a):(c.$a++,c.$a>c.c.checkBetSlipAddedMaxCounter?(m.i("AddBetslipTimeout",c.g,"Timeout. Cannot add bet to betslip with id: "+c.a.htmlID,"",c.a),c.f(languages.selected.error_addToBetslip,null)):setTimeout(function(){c.W(a)},c.c.checkBetSlipAddedInterval))},2e3)}},this.$c=function(){var a=null;if(!this.betFinishedFlag){null==a&&(a=0);var c=this;c.e({action:"getMinMaxStake",betID:c.a.htmlID},function(a){a&&a.retval?(c.a.minStake=a.retval.minStake,c.a.maxStake=a.retval.maxStake,c.b("getBetSlipData")):(m.i("ParseMinMaxStake",c.g,"Cannot get min and max stake.","",c.a),c.f(languages.selected.error_getMinMaxStake,null))})}},this.yc=function(){var a=this;1==a.Ja&&!0!==a.c.ge?a.b("addBetSlip"):a.e({action:"checkBetSlipCleared"},function(c){c&&1==c.retval?(a.Ja=!0,a.b("addBetSlip")):a.e({action:"clearBetSlip"},function(c){c&&1==c.retval?(a.ab=0,a.lb("addBetSlip")):(m.i("ClearBetslip",a.g,"Cannot clear betslip","",a.a),a.f(languages.selected.error_clearBetslip,null))})})},this.lb=function(a){if(!this.betFinishedFlag){var c=this;c.e({action:"checkBetSlipCleared"},function(e){e&&1==e.retval?(c.Ja=!0,c.b(a)):(c.ab++,c.ab>c.c.checkBetSlipClearedMaxCounter?(m.i("ClearBetslipTimeout",c.g,"Timeout. Cannot clear betslip.","",c.a),c.f(languages.selected.error_clearBetslip,null)):setTimeout(function(){c.lb(a)},c.c.checkBetSlipClearedInterval))})}},this.openBetSlip=function(a){if(void 0==this.c.sc)this.b(a);else{var c=this;c.e({action:"checkBetSlipOpened"},function(e){e&&1==e.retval?c.b(a):c.e({action:"openBetSlip"},function(e){e&&1==e.retval?(c.bb=0,c.checkBetSlipOpened(a)):(m.i("OpenBetslip",c.g,"Cannot open betslip.","",c.a),c.f(languages.selected.error_openBetslip,null))})})}},this.checkBetSlipOpened=function(a){if(!this.betFinishedFlag){var c=this;c.e({action:"checkBetSlipOpened"},function(e){e&&1==e.retval?c.b(a):(c.bb++,c.bb>c.c.sc?(m.i("OpenBetslipTimeout",c.g,"Timeout. Cannot open betslip.","",c.a),c.f(languages.selected.error_openBetslip,null)):setTimeout(function(){c.checkBetSlipOpened(a)},c.c.ie))})}},this.kb=function(a){var c=this;c.e({action:"checkAreWeOnBetPage"},function(e){e&&e.retval.error?languages.selected[e.retval.error]?(m.i(e.retval.error,c.g,e.retval.error,e.retval.Z,c.a),c.f(languages.selected[e.retval.error],null)):(m.i(e.retval.error,c.g,e.retval.error,e.retval.Z,c.a),c.f(languages.selected.error_error,null)):c.b(e.retval?"correctBetPage":a)})},this.ca=function(a,c,e){q.ca(this,a,c,e)},this.ba=function(a,c,e){q.ba(this,a,c,e)},this.O=function(a){q.O(this,a)},this.onTabReplaced=function(a,c){q.onTabReplaced(this,a,c)},this.f=function(a,c){null==c&&(c=this.J),m.ja(languages.selected.error_error,a,"error",c,this.c.bookieName),this.b("error")},this.Sa=function(a){var c=null;null==c&&(c=this.J),m.ja(languages.selected.error_warning,a,"warning",c,this.c.bookieName),this.a.progress.type="warning"},this.e=function(a,c,e){e||(e=scriptLoader.scriptList.disableWatchdog?3e5:3e4),q.e(this,a,c,e)},this.D=new x,this.xa(),this}function x(){this.xa=function(){this.T=!0,this.l=[],this.a=null,this.progress={},this.progress.finished=!1,this.progress.active=!1,this.progress.type="info",this.progress.percent=0,this.progress.title=languages.selected.progressBetPlace_start},this.ac=function(){1==this.T&&0<this.l.length&&(this.T=!1,this.b("startPlace"))},this.va=function(a,c){var b=arbHandler.F(a);b&&(c&&(b.amount=c),this.l.push(b))},this.finish=function(){this.T=!0,this.l=[]},this.b=function(a){(1!=this.T||"error"==a)&&("startPlace"==a?(this.progress.percent=0,this.progress.active=!0,this.W("checkBetSlipChanged")):"checkBetSlipChanged"==a?(this.progress.percent=0,this.progress.active=!0,this.ra("checkLoggedIn")):"checkLoggedIn"==a?(this.progress.percent=15,this.parent.la("betPlacer_getBalance","betPlacer_checkBalance")):"getBalance"==a?(this.progress.percent=25,this.parent.yb("betPlacer_checkBalance")):"checkBalance"==a?(this.progress.percent=35,this.rc()):"betAdded"==a?(this.progress.percent=50,this.progress.title=languages.selected.progressBetPlace_setAmount,this.Xb("getTotalAmountSet")):"getTotalAmountSet"==a?(this.progress.percent=75,this.progress.title=languages.selected.progressBetPlace_checkAmount,this.Cb("success")):"error"==a?(this.progress.type="error",1!=this.T&&this.b("finish")):"success"==a?(this.progress.percent=100,this.progress.type="success",this.b("finish")):"finish"==a&&(this.progress.active=!1,this.progress.finished=!0,this.finish()),arbHandler.de(this.parent.c.bookieName,this.progress),arbHandler.gb())},this.rc=function(){for(var a=0,c=0,b=0;b<this.l.length;b++){var d=arbHandler.F(this.l[b].id);d&&(c=d.balance),a=0==d.leg.indexOf("L")?a+this.l[b].amount*(this.l[b].decimalOdd-1):a+this.l[b].amount}a>c&&this.parent.Sa(languages.selected.error_balance),this.b("betAdded")},this.W=function(a,c){var b=this;null==c&&(c=0),c<b.l.length?(b.a=b.l[c],b.parent.e({action:"checkBetSlipAdded",betID:b.a.htmlID},function(d){1==d.retval?b.W(a,++c):(b.parent.f(languages.selected.error_checkBetAdded+b.a.htmlID,b.a.id),b.b("error"))})):b.b(a)},this.ra=function(a,c){var b=this;null==c&&(c=0),c<b.l.length?(b.a=b.l[c],b.parent.e({action:"getBetSlipData",betID:b.a.htmlID},function(d){d&&d.retval.error||!d?b.parent.f(languages.selected.error_parseBetslip,null):w.Cc(b.a.betBetslip,d.retval.bet)?b.ra(a,++c):(b.parent.f(languages.selected.error_betSlipUpdated,b.a.id),b.b("error"))})):b.b(a)},this.Xb=function(a,c){var b=this;null==c&&(c=0),c<b.l.length?(b.a=b.l[c],this.parent.e({action:"setAmount",betID:b.a.htmlID,amount:b.a.amount},function(d){d&&1==d.retval?b.Xb(a,++c):(b.parent.f(languages.selected.error_setAmount,b.a.id),b.b("error"))})):b.b(a)},this.O=function(){this.b("error")},this.Cb=function(a,c){null==c&&(c=0);var b=this,d=200,e=15;b.parent.c.uc&&(d=b.c.uc),b.parent.c.vc&&(e=b.c.vc),this.parent.e({action:"getTotalAmountSet"},function(g){g||(g={retval:0}),g=parseFloat(g.retval);for(var f=0,h=0;h<b.l.length;h++)f+=parseFloat(b.l[h].amount);e>c?g==f?b.b(a):setTimeout(function(){b.Cb(a,++c)},d):(g=languages.selected.error_totalAmount.replace("%total%",g).replace("%expected%",parseFloat(f)),b.parent.f(g,-1),b.b("error"))})}}var E={nd:"lukia. tipico. unibet. bet365. ladbrokes. 888sport. paf.".split(" "),Gc:{Xd:["luckia","sportium"],Mc:["marathonbetUk"]},fe:{code:"wo",path:"handlers/worldwideHandlers/"},Xd:{code:"es",path:"handlers/spanishHandlers/"},Mc:{code:"uk",path:"handlers/englishUkHandlers/"},sb:{path:"handlers/coreHandlers/",zd:{core24hpoker:["24hpoker","smartlivegaming","noxwin"],corePaf:["paf","unibet","luckia","888sport","32redsport"],coreTitanbet:["titanbet","winner","vernons"],coreMarathonbet:["marathonbet","marathonbetUk"],coreBetVictor:["mcbookie","betvictor"],core12bet:["12bet","1bet"],coretipico:["tipico","rivalo"]}}},runtimeOrExtension=chrome.runtime&&chrome.runtime.sendMessage?"runtime":"extension",q=new function(){this.Oa=function(a,c,b,d){var e=a.c.bookieURL;chrome.windows.getAll({populate:!0},function(g){for(var k,f=0,h=g.length;h>f;f++){k=g[f];for(var v,p=0,n=k.tabs.length;n>p;p++)if(v=k.tabs[p],0<=v.url.indexOf(c))return a.tab=v,void a.b(d)}chrome.tabs.create({url:e,selected:!1},function(d){a.tab=d,a.b(b)})})},this.ma=function(a){a.tab&&chrome.tabs.get(a.tab.id,function(c){c&&"complete"!==c.status||chrome.tabs.executeScript(a.tab.id,{code:"var handler = null; var handlerScriptIsLoaded = false; sIc();"},function(){})})},this.N=function(a){if(1!=a.Wb){var c=function(a){chrome.tabs.get(a.tab.id,function(d){d&&"complete"!==d.status?setTimeout(function(){c(a)},300):chrome.tabs.executeScript(a.tab.id,{code:"sIc();"},function(){a.Wb=!1,chrome.runtime.lastError&&(a.Gb=!0,a.b("injectionError"))})}.bind(this))};a.Wb=!0,c(a)}},this.Na=function(a,c,b){chrome.tabs.update(a.tab.id,{url:c.retval.url},function(){a.b(b)})},this.I=function(a,c,b){a.gc(),void 0==b&&(b=0),0==b?(a.fa=b,a.ya=c,setTimeout(function(){a.N()},200)):(a.fa=b,a.ya=c)},this.e=function(a,c,b,d){chrome.tabs.get(a.tab.id,function(e){try{a.Gb||!e||a.sa&&"complete"==e.status?(c.bookieName=a.c.bookieName,l.Qd(a.tab.id,c,b,d)):setTimeout(function(){this.e(a,c,b,d)}.bind(this),300)}catch(g){}}.bind(this))},this.ba=function(a,c,b,d){return a&&a.tab&&b&&b.tab&&a.tab.id==b.tab.id&&("getBet"==c.action?d({bet:a.a}):"injectCheck"==c.action?0==c.loaded?chrome.tabs.get(a.tab.id,function(b){if(b&&"complete"!==b.status)setTimeout(function(){a.N()},200);else{var d=function(){chrome.tabs.executeScript(a.tab.id,{code:scriptLoader.scripts["content_bookie_scripts.js"]},function(){chrome.tabs.executeScript(a.tab.id,{code:scriptLoader.scripts["content_oddconverter.js"]},function(){var b=scriptLoader.scripts[a.c.Ob+a.c.bookieName+".js"];if(scriptLoader.scriptList.evalWithName&&(b+="\n//handler"+a.c.bookieName),!_.isUndefined(a.c.na)){var d=scriptLoader.scripts[a.c.na];scriptLoader.scriptList.evalWithName&&(d+="\n//handlerCore"+a.c.bookieName),chrome.tabs.executeScript(a.tab.id,{code:d},function(){})}chrome.tabs.executeScript(a.tab.id,{code:b},function(){chrome.tabs.executeScript(a.tab.id,{code:scriptLoader.scripts["libraries/moment.js"]},function(){chrome.tabs.executeScript(a.tab.id,{code:scriptLoader.scripts["libraries/timezones.js"]},function(){chrome.tabs.executeScript(a.tab.id,{code:scriptLoader.scripts["libraries/unorm.js"]},function(){chrome.tabs.executeScript(a.tab.id,{code:"var handler = "+a.c.objName+"; \nhandler.bet = "+JSON.stringify(a.a)+"; \nif ((typeof handler.bet.customUrl != 'undefined') && handler.bet.customUrl !== '') handler.bookieURL = handler.bet.customUrl; \nif (handler.bet.gameReversed == 1) handler.bet = D27_(handler.bet); \nvar handlerScriptIsLoaded = true;"},function(){setTimeout(function(){a.N()},200)})})})})})})})};scriptLoader.scriptList.alwaysReloadHandler?scriptLoader.get(a.c.Ob+a.c.bookieName+".js",function(b,c,e){c||(scriptLoader.scripts[b]=e),_.isUndefined(a.c.na)?d():scriptLoader.get(a.c.na,function(a,b,c){b||(scriptLoader.scripts[a]=c),d()})}):d()}}):1==c.loaded&&(a.sa=!0,0>=a.fa&&null!=a.ya&&(a.b(a.ya),a.ya=null)):"pageReloaded"==c.action&&(a.sa=!1)),!0},this.O=function(a,c){a.tab&&a.tab.id==c&&(m.i("TabClosed",a.g,"Tab is closed","",a.a),a.D.O(),a.f("Tab is closed",-1))},this.ca=function(a,c,b){a&&a.tab&&a.tab.id==c&&"complete"==b.status&&(0<=a.fa&&a.fa--,0>=a.fa&&setTimeout(function(){a.N()},200))},this.onTabReplaced=function(a,c,b){a.tab.id==b&&(a.sa=!1,a.tab.id=c,chrome.tabs.get(c,function(b){a.tab=b,setTimeout(function(){a.N()},200)}))}},D=new function(){this.La=!1,this.md=function(a,c,b,d){if("oursite"===d.name){if("clearSideBar"===a.action)t.zc(),t.dc();else if("newArb"===a.action)l.wc(a.arbData.lastUpdate,function(){arbHandler.rd(a.arbData)}.bind(this));else if("updateArb"===a.action)arbHandler.ce(a.arbData);else if("refreshArbStakes"===a.action)arbHandler.Ed(a.arbData);else if("removedArb"===a.action)arbHandler.Md(a.arbData.arbid,a.arbData.bestPercent);else if("duplicateBookie"===a.action)arbHandler.Kc(a.arbData.arbid);else if("closeArb"===a.action)arbHandler.Ac(a.arbData.arbid);else if("handler"===a.action)B.ke(a.arbData);else if("arbvestorOpened"===a.action){var e=l.Bb(c);e&&u.td(e)}else"sidebarSites"===a.action?(t.ea=_.cloneDeep(a.arbData),C.Td()):"uninstall"===a.action&&l.uninstall();t.za.aa(a.action)}("sidebar"===d.name||"oursite"===d.name)&&("getSideBarContent"===a.action?(e=t.Ia(),b({head:e,content:t.Vc(),contentscript:t.Wc(),tour:t.za.tour})):"noSuppressAlerts"===a.action?D.La=!1:"suppressAlerts"===a.action?D.La=!0:"isAlertsSuppressed"===a.action?b(D.La):"isSidebarSite"===a.action?t.Ma(a.url,function(a){b(a)}):"isSideBarVisible"===a.action?b({visible:t.R,width:"400px"}):"showTab"===a.action?t.Xa(a.bookiename):"closeTab"===a.action?t.pb(a.bookiename):"closeAlert"===a.action?arbHandler.ne(a.betid,a.alertid):"showHome"===a.action?t.ia():"findArb"===a.action?t.Fa():"startTour"===a.action?(t.za.Zd(),arbHandler.o()):"hopscotch"===a.action?(t.za.b(a.data),arbHandler.o()):"placeBets"===a.action?a.disabled||arbHandler.Bd():"placeBet"===a.action?a.disabled||arbHandler.va(a.betid):"toggleSidebar"===a.action?this.cc():"autoAdjustToggle"===a.action?arbHandler.currentArb&&arbHandler.currentArb.arb&&(arbHandler.currentArb.arb.autoAdjustStake=a.checked,!0===arbHandler.currentArb.arb.autoAdjustStake&&l.n(u.k,"calcStakes",{currentArb:arbHandler.currentArb,value:a.value,direction:a.direction}),arbHandler.o()):"calcStakes"===a.action?(arbHandler.currentArb.fc=!0,l.n(u.k,"calcStakes",{currentArb:arbHandler.currentArb,value:a.value,direction:a.direction})):"calcStakesFromBet"===a.action?(arbHandler.currentArb.fc=!0,l.n(u.k,"calcStakesFromBet",{currentArb:arbHandler.currentArb,value:a.value,betid:a.betid,direction:a.direction})):"calcMaxStakes"===a.action?l.n(u.k,"calcMaxStakes",arbHandler.currentArb):"confirmUpdate"===a.action?arbHandler.rb(a.value):"replay"===a.action?arbHandler.Ra(a.betid):"stop"===a.action?arbHandler.Za(a.betid):"preLoadImage"===a.action?b({image:l.Jb}):"setBookkeeper"===a.action&&l.n(u.k,"setBookkeepping",{currentArb:arbHandler.currentArb})),("compatibility"===d.name||"bookiescript"===d.name)&&(B.ba(a,c,b),"pageReloaded"===a.action&&(e=l.Bb(c))&&(u.yd(e),l.$d()),"getLanguage"===a.action&&b(languages.selected[a.translate]))},this.da=function(a){l.da(a)},this.cc=function(){t.R=1==t.R?!1:!0,l.setIcon(t.R),D.da({action:"checkVisibility"}),u.n("toggleSidebar",{}),arbHandler.o()},this.Nb=function(){D.cc()},this.xd=function(a,c,b){B.ca(a,c,b)},this.wd=function(a){B.O(a),u.bc(a)},this.onTabReplaced=function(a,c){B.onTabReplaced(a,c)}};window.betfinderToolBarClick=D.Nb;var u=new function(){this.k=null,this.C=[],this.n=function(a,c){null!=this.k&&l.n(this.k,a,c)},this.td=function(a){if(null==this.k)this.k=a,arbHandler.Y(),l.Wa(this.k,{action:"messageToOursite",message:"enable"}),t.Ma("about:blank",function(){});else if(this.k!==a){for(var c=0;c<this.C;c++)if(a===this.C[c])return;this.C.push(a)}},this.yd=function(a){this.bc(a)},this.bc=function(a){if(a===this.k)0<this.C.length?(this.k=this.C.pop(),l.Wa(this.k,{action:"messageToOursite",message:"enable"})):this.k=null,arbHandler.Y();else{for(var c=[],b=0;b<this.C.length;b++)a!==this.C[b]&&c.push(this.C[b]);this.C=c}}},arbHandler=new function(){this.types={0:"success",1:"info",2:"warning",3:"error"},this.currentArb={arbEmpty:!0},this.updatedArb={},this.A=!1,this.Nd=function(){this.currentArb={arbEmpty:!0},this.updatedArb={}},this.rd=function(a){this.currentArb=_.cloneDeep(a),this.A=!1,this.currentArb.arb.Ya=!0,this.currentArb.arb.autoAdjustStake=!0,this.currentArb.updatedActualPcnt=!1,_.cloneDeep(a),this.Ba(),this.o()},this.Ed=function(a){this.currentArb.arb.totalStake=a.arb.totalStake,this.currentArb.arb.earn=a.arb.earn;for(var c=0;c<this.currentArb.bets.length;c++)this.currentArb.bets[c].earn=a.bets[c].earn,this.currentArb.bets[c].amount=a.bets[c].amount,_.isUndefined(a.bets[c].liability)?delete this.currentArb.bets[c].liability:this.currentArb.bets[c].liability=a.bets[c].liability,_.isUndefined(a.bets[c].amountBase)?_.isUndefined(this.currentArb.bets[c].amountBase)||delete this.currentArb.bets[c].amountBase:this.currentArb.bets[c].amountBase=a.bets[c].amountBase;m.jb(),this.o()},this.ce=function(a){_.isUndefined(this.currentArb.updatedArbConfirm)||delete this.currentArb.updatedArbConfirm,a.arb&&this.currentArb.arb&&a.arb.tLU>this.currentArb.arb.tLU&&(a.arb.actualPcnt<a.arb.bestPercentage&&0<a.arb.bestPercentage&&(a.arb.le=!0),this.currentArb.updatedArb=_.cloneDeep(a),this.currentArb.updatedActualPcnt=!0,this.Fc()||(this.rb("true"),this.currentArb.updatedArbConfirm=_.cloneDeep(a))),this.o()},this.Fc=function(){if(0>this.currentArb.updatedArb.arb.actualPcnt)return!0;if(this.currentArb.arb.active)return!1;for(var a=0;a<this.currentArb.bets.length;a++)if(1e4<this.currentArb.updatedArb.bets[a].tLU-this.currentArb.bets[a].tLU)return!0;return!1},this.rb=function(a){if("true"==a){a=this.currentArb.updatedArb,delete this.currentArb.updatedArb,_.isUndefined(this.currentArb.updatedActualPcnt)||delete this.currentArb.updatedActualPcnt,_.extend(this.currentArb.arb,a.arb),this.currentArb.arb.changePcnt=a.arb.actualPcnt-this.currentArb.arb.actualPcnt,this.currentArb.changeTime=(new Date).getTime();for(var c=[],b=0;b<this.currentArb.bets.length;b++){if(a.bets[b].tLU>this.currentArb.bets[b].tLU){var d=a.bets[b].decimalOdd-this.currentArb.bets[b].decimalOdd;_.extend(this.currentArb.bets[b],a.bets[b]),this.currentArb.bets[b].changeDecimalOdd=d,0<Math.abs(d)&&(this.currentArb.arb.Ya=!0),c.push(this.currentArb.bets[b].id)}else this.currentArb.bets[b].amount=a.bets[b].amount,this.currentArb.bets[b].earn=a.bets[b].earn;delete this.currentArb.bets[b].amountBase}this.Ba(!0,c),this.o()}else"bestPcnt"===a?u.n("getBestSelection",""):u.n("closeArb","")},this.Y=function(){try{this.Nd(),B.Yb(),this.o()}catch(a){}},this.Kc=function(){this.Y(),this.currentArb.arbAlerts=[],this.currentArb.arbAlerts.push({duplicateBookie:!0}),this.o()},this.Ac=function(a){this.currentArb.arb&&a==this.currentArb.arb.id&&(this.Y(),this.currentArb.arbEmpty=!0,this.o())},this.Md=function(a,c){0>=c&&(c=null),this.currentArb.arb&&a===this.currentArb.arb.id&&(this.currentArb.arbAlerts=[],this.currentArb.arbAlerts.push({arbRemoved:!0,bestPercent:c}),this.currentArb.updatedActualPcnt=!0,this.o())},this.Ra=function(a){a=this.zb(a),null!=a&&(a=this.currentArb.bets[a],a&&a.progress&&a.progress.active||(a=this.Ha(a.bookieName),delete arbHandler.currentArb.me,this.Ba(!0,a),m.jb()))},this.Za=function(a){a=this.zb(a);var c=this.currentArb.bets[a];null!=a&&B.Ab(c.bookieName,c.checksum,function(a){a.Za()})},this.Ba=function(a,c){a||(a=!1),c||(c=this.currentArb.bets),a||B.Yb();for(var b=0;b<c.length;b++){var d=c[b];("number"==typeof d||"string"==typeof d)&&(d=this.F(d)),d&&this.ic(d,a)}},this.ic=function(a,c){B.Ab(a.bookieName,a.checksum,function(b){b.jc(a.id,c),b.$b()})},this.Bd=function(){if(this.currentArb&&this.currentArb.bets)for(var a=0;a<this.currentArb.bets.length;a++){var c=this.currentArb.bets[a],b=B.j[c.bookieName];b&&(b.D.va(c.id,c.amount),b.D.ac())}},this.va=function(a){var c=arbHandler.F(a);if(c&&(a=B.j[c.bookieName],c=arbHandler.Ha(c.bookieName),0<c.length&&a))for(var b=0;b<c.length;b++)a.D.va(c[b].id,c[b].amount),a.D.ac()},this.de=function(a,c){for(var b=arbHandler.Ha(a),d=0;d<b.length;d++)b[d].betPlaceProgress=c},this.gb=function(){var a=0,c=0;if(this.currentArb&&this.currentArb.bets){for(var b=0;b<this.currentArb.bets.length;b++)this.currentArb.bets[b].progress?(this.currentArb.bets[b].progress.active||this.currentArb.bets[b].betPlaceProgress.active)&&a++:a++,this.currentArb.bets[b].progress&&this.currentArb.bets[b].progress.finished&&"error"!=this.currentArb.bets[b].progress.type?(this.currentArb.bets[b].enablePlaceBets=!0,c++):this.currentArb.bets[b].enablePlaceBets=!1;if(a>0)for(b=0;b<this.currentArb.bets.length;b++)this.currentArb.bets[b].enablePlaceBets=!1;this.currentArb.arb.enablePlaceBets=c==this.currentArb.bets.length&&0==a?!0:!1}this.o()},this.pc=function(){for(var a=0,c=0;c<this.currentArb.bets.length;c++)this.currentArb.bets[c].progress&&this.currentArb.bets[c].progress.finished&&a++;if(a==this.currentArb.bets.length){for(a={},c=0;c<this.currentArb.bets.length;c++){var b=this.currentArb.bets[c];a[b.id]=m.Rc(b)}u.n("arbFinished",a),this.currentArb.arb&&this.currentArb.arb.Ya&&!arbHandler.currentArb.fc&&(this.currentArb.arb.Ya=!1,l.n(u.k,"calcMaxStakes",arbHandler.currentArb))}},this.Ha=function(a){var c=[];if(this.currentArb&&this.currentArb.bets)for(var b=0;b<this.currentArb.bets.length;b++)this.currentArb.bets[b].bookieName==a&&c.push(this.currentArb.bets[b]);

return c},this.zb=function(a){if(this.currentArb&&this.currentArb.bets)for(var c=0;c<this.currentArb.bets.length;c++)if(this.currentArb.bets[c].id==a)return c;return null},this.F=function(a){if(this.currentArb&&this.currentArb.bets)for(var c=0;c<this.currentArb.bets.length;c++)if(this.currentArb.bets[c].id==a)return this.currentArb.bets[c];return null},this.o=function(){var a=arbHandler.currentArb;arbHandler.A?arbHandler.ec=!0:(arbHandler.A=!0,t.Jc(a),t.dc(),u.n("updateGUI",_.cloneDeep(a)),setTimeout(function(){arbHandler.A=!1,arbHandler.ec&&(arbHandler.ec=!1,arbHandler.o())}.bind(this),500))}};window.arbHandler=arbHandler;var B=new function(){this.j={},this.X={},this.Yb=function(){for(var a in this.j)this.j[a].xa()},this.Ab=function(a,c,b){var d=this.ad(a),e=d+a+".js";this.X[a]||(this.X[a]=md5(scriptLoader.scripts[e]));var g=this.Ea(a,!1,null);g?scriptLoader.get(g,function(g,h,k){h||(h={},h[g]=k,l.Zb(h,function(){this.vb(c,a,e,b,k,d)}.bind(this)))}.bind(this)):this.vb(c,a,e,b,null,d)},this.vb=function(a,c,b,d,e,g){a==this.X[c]?(e=this.Ea(c,!0,e),this.qa(c,scriptLoader.scripts[b],e,g,d)):scriptLoader.get(b,function(b,e,k){e?this.qa(c,null,!1,pathExecutor,g):(e={},e[b]=k,l.Zb(e,function(){if(this.X[c]=md5(k),a==this.X[c]){var b=this.Ea(c,!0,k);this.qa(c,k,b,g,d)}else this.qa(c,null,!1,g,d)}.bind(this)))}.bind(this))},this.ad=function(a){var c=_.findKey(E.Gc,function(c){return 0<=c.indexOf(a)});return _.isUndefined(c)||-1==c?E.fe.path:E[c].path},this.Ea=function(a,c,b){var d=_.findKey(E.sb.zd,function(c){return 0<=c.indexOf(a)});return _.isUndefined(d)||-1==d?!1:(d=E.sb.path+d+".js",c&&eval(null!==b?b:scriptLoader.scripts[d]),d)},this.qa=function(a,c,b,d,e){var g="handler"+a;try{if(eval(c),this[g]=eval(g),null==c)throw Error("handlerCode is null")}catch(f){this[g]={error:"Cannot eval bookie handler("+g+"): "+f}}c=this[g],null==c.bookieName&&(c.bookieName=a),b&&(c.na=b),c.Ob=d,c&&(null==B.j[a]?B.j[a]=new r(c):B.j[a].c=c,e(B.j[a]))},this.ca=function(a,c,b){for(var d in this.j)this.j[d].ca(a,c,b)},this.onTabReplaced=function(a,c){for(var b in this.j)this.j[b].onTabReplaced(a,c)},this.ba=function(a,c,b){for(var d in this.j)this.j[d].ba(a,c,b)},this.O=function(a){for(var c in this.j)this.j[c].O(a)}},runtimeOrExtension=chrome.runtime&&chrome.runtime.sendMessage?"runtime":"extension",l=new function(){this.Ka=function(){RCLoader.onClickEnabled=!1,l.version=chrome.runtime.getManifest().version,l.Pa=0;var a=document.createElement("canvas");a.id="mainCanvas",document.documentElement.appendChild(a),arbHandler.Y(),l.Id(),l.Gd(),l.setIcon(t.R)},this.uninstall=function(){chrome.management.uninstallSelf()},this.Hd=function(){this.da({action:"sidebarOff",width:"400px"}),setTimeout(function(){chrome.runtime.reload()},200)},this.Id=function(){chrome.tabs.query({},function(a){for(var c=0;c<a.length;++c)a[c].url.match(scriptLoader.scriptList.homeSitePattern)&&(chrome.tabs.reload(a[c].id),C.ia(a[c].id))})},this.Gd=function(){chrome.tabs.query({},function(a){for(var c=0;c<a.length;++c)0!=a[c].url.indexOf("chrome")&&chrome.tabs.reload(a[c].id)})},this.Kb=0,this.Jb=null,this.ports=[],this.sd=function(a){"betfinder"===a.name&&(l.ports.push(a),l.Pa+=1,a.Pb=l.Pa,a.p={},a.V={},a.U=0,a.onMessage.addListener(function(c){if(null!=c&&null!=c._respId&&null!=c._respOrig&&null!=c._portName&&null!=c._respIsResp&&("sidebar"==c._portName||"oursite"==c._portName||"compatibility"==c._portName||"bookiescript"==c._portName))if(c._respIsResp){if(a.p[c._respId]){var b=a.p[c._respId];a.V[c._respId]&&(clearTimeout(a.V[c._respId]),delete a.V[c._respId]),delete a.p[c._respId],b(c._respOrig)}}else D.md(c._respOrig,a.sender,function(d){var b={};b._respOrig=JSON.parse(JSON.stringify(d)),b._respIsResp=!0,b._respId=c._respId,b._portName=c._portName,a.postMessage(b)},{name:c._portName})}),a.onDisconnect.addListener(function(a){a.p={};for(var b=[],d=0;d<l.ports.length;d++)l.ports[d].Pb!=a.Pb&&b.push(l.ports[d]);l.ports=b}),a.sendMessage=function(c,b,d,e){this.U++;var g=a.U;d&&(this.p[g]=d,e&&(d=setTimeout(function(a,c){if(a&&a.p&&a.p[c]){var d=a.p[c];delete a.p[c],delete a.V[c],d(null)}},e,a,g),this.V[g]=d)),d={},d._portName=b,d._respId=g,d._respIsResp=!1,d._respOrig=JSON.parse(JSON.stringify(c)),this.postMessage(d)})},this.Qd=function(a,c,b,d){for(var e=0;e<this.ports.length;e++)this.ports[e]&&this.ports[e].sender&&this.ports[e].sender.tab&&this.ports[e].sender.tab.id===a&&this.ports[e].sendMessage(c,"bookiescript",b,d)},this.da=function(a,c){for(var b=0;b<this.ports.length;b++)this.ports[b]&&this.ports[b].sender&&this.ports[b].sender.tab&&this.ports[b].sendMessage(a,"sidebar",c)},this.Wa=function(a,c){for(var b=0;b<this.ports.length;b++)this.ports[b]&&this.ports[b].sender&&this.ports[b].sender.tab&&this.ports[b].sender.tab.id===a&&this.ports[b].sendMessage(c,"oursite",void 0)},this.n=function(a,c,b){var d=null;arbHandler.currentArb.arb&&arbHandler.currentArb.arb.id&&(d=arbHandler.currentArb.arb.id),this.Wa(a,{action:"sendMessageToArbvestor",message:{action:c,arbid:d,data:b}})},this.Bb=function(a){return a&&a.tab?a.tab.id:null},this.$d=function(){500>(new Date).getTime()-l.Kb||!1!==t.R&&chrome.tabs.query({},function(a){for(var c=[],b=0;b<a.length;++b)!0===a[b].active&&c.push(a[b]);for(a=0;a<c.length;a++)if((b=c[a].url)&&t.Ma(b)){chrome.tabs.captureVisibleTab(c[a].windowId,{quality:100,format:"png"},function(a){var c=document.getElementById("mainCanvas"),b=c.getContext("2d"),f=new Image;f.onload=function(){c.width=400,c.height=f.height,b.globalAlpha=1,b.drawImage(f,0,0,400,f.height,0,0,400,f.height),l.Jb=c.toDataURL(),l.Kb=(new Date).getTime()},void 0!=a&&(f.src=a)});break}})},this.setIcon=function(a){var c="icon19.png",b="On";a||(c="icon19_off.png",b="Off"),this.Yc(c,function(a){a&&(chrome.browserAction.setIcon({imageData:a}),chrome.browserAction.setTitle({title:"Betfinder Sidebar "+b}))})},this.Yc=function(a,c){var b="resources/icons/"+a;chrome.storage.local.get(b,function(a){if(a[b]){a=JSON.parse(a[b]);var g,e=[];for(g in a.data)e[g]=a.data[g];g=new Uint8ClampedArray(e);var f=document.createElement("canvas");f.width=a.width,f.height=a.height,a=f.getContext("2d").createImageData(a.width,a.height),a.data.set(g),c(a)}else{var f=document.createElement("canvas"),h=new Image;h.onload=function(){var a=f.getContext("2d");a.drawImage(this,0,0);var d=a.getImageData(0,0,h.width,h.height),a={};a[b]=JSON.stringify(d),chrome.storage.local.set(a,function(){c(d)})},h.onerror=function(){c(null)},h.src=scriptLoader.scriptList.resourceURL+b}})},this.wc=function(a,c){chrome.storage.local.get("scriptList",function(b){b.scriptList&&a>b.scriptList.lastUpdate?this.Hd():"function"==typeof c&&c()}.bind(this))},this.Zb=function(a,c){chrome.storage.local.set(a),"function"==typeof c&&c()}},C=new function(){this.Bc=function(a){B.j[a]&&B.j[a].tab&&chrome.tabs.remove(B.j[a].tab.id)},this.Xa=function(a){B.j[a].tab.id&&chrome.tabs.update(B.j[a].tab.id,{active:!0,highlighted:!0})},this.ia=function(a){null==a?chrome.tabs.create({url:scriptLoader.scriptList.homeSite,active:!0}):chrome.tabs.update(a,{active:!0,highlighted:!0})},this.Fa=function(){l.n(u.k,"findArb","")},this.Ia=function(){for(var a=t.G.head.innerHTML,c=a.match(RegExp('"resource://betfinder/([^"]*)"',"g")),b=0;b<c.length;b++)var d=c[b].replace("resource://betfinder/","").replace(/"/g,""),a=a.replace(c[b],scriptLoader.scriptList.resourceURL+"resources/"+d);return a},this.Td=function(){var a={};a.sidebarSites=JSON.stringify(t.ea),chrome.storage.local.set(a,function(){})},this.Zc=function(a){chrome.storage.local.get("sidebarSites",function(c){var b=null;c.sidebarSites&&(b=JSON.parse(c.sidebarSites)),"function"==typeof a&&a(b)}.bind(this))}};chrome.runtime.onConnect.addListener(l.sd),chrome.tabs.onUpdated.addListener(function(a,c,b){if(c)if("loading"==c.status){if(b&&0!=b.url.indexOf("http"))return;chrome.tabs.executeScript(a,{code:"var resourceURL = '"+scriptLoader.scriptList.resourceURL+"'; "+scriptLoader.scripts["content_compatibility.js"],runAt:"document_start"},function(){})}else"complete"==c.status&&(chrome.tabs.executeScript(a,{code:scriptLoader.scripts["content_sidebar.js"],runAt:"document_end"},function(){}),b&&b.url&&b.url.match(scriptLoader.scriptList.homeSitePattern)&&(new URL(b.url).origin==scriptLoader.scriptList.homeSitePattern||-1<b.url.indexOf("localhost"))&&chrome.tabs.executeScript(a,{code:"window['extensionVersion'] = '"+(scriptLoader.scriptList.useDevelopVersion?"develop":l.version)+"'; "+scriptLoader.scripts["content_oursite_script.js"],runAt:"document_end"},function(){}));D.xd(a,c,b)}),chrome.tabs.onRemoved.addListener(D.wd),chrome.tabs.onReplaced.addListener(function(a,c){D.onTabReplaced(a,c)}),chrome.browserAction.onClicked.addListener(D.Nb),chrome.webRequest.onBeforeSendHeaders.addListener(function(a){try{var c=new URL(a.url).hostname,b=_.findIndex(E.nd,function(a){return-1!=c.indexOf(a)?!0:!1});if(!_.isUndefined(b)&&-1!=b){for(b=0;b<a.requestHeaders.length;++b)if("User-Agent"===a.requestHeaders[b].name){a.requestHeaders[b].value="Mozilla/5.0 (Linux; U; Android 4.2; en-us; Nexus 4 Build/JOP24G) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30";break}return{requestHeaders:a.requestHeaders}}}catch(d){}return{}},{urls:["<all_urls>"]},["blocking","requestHeaders"]),window.initialize=l.Ka;var m=new function(){this.ja=function(a,c,b,d,e){var g={};if(g.title=a,g.message=c,null==b&&(b="warning"),g.type=b,-1==d){if(arbHandler.currentArb&&arbHandler.currentArb.bets)for(a=0;a<arbHandler.currentArb.bets.length;a++)arbHandler.currentArb.bets[a].bookieName==e&&(this.eb(arbHandler.currentArb.bets[a],g),null==arbHandler.currentArb.bets[a].progress&&(arbHandler.currentArb.bets[a].progress={}))}else this.eb(arbHandler.F(d),g)},this.eb=function(a,c){if(a){a.progress&&(a.progress.type="error"==a.progress.type?"error":"warning"==a.progress.type&&"info"==c.type?"warning":c.type),null==a.alerts&&(a.alerts=[]),a.alerts.push(c);for(var b=0;b<a.alerts.length;b++)a.alerts[b].alertid=b}},this.Oc=function(a,c){var b={action:"betChange",data:a};null==c.feedbacks&&(c.feedbacks=[]),c.feedbacks.push(b)},this.i=function(a,c,b,d,e){a={action:"error",data:{type:a,betid:e.id,state:c,error:b,stack:d}},null==e.feedbacks&&(e.feedbacks=[]),e.feedbacks.push(a)},this.Rc=function(a){if(!a)return null;var c="success";return a.progress&&"warning"==a.progress.type&&(c="warning"),a.progress&&"error"==a.progress.type&&(c="error"),{state:c,alerts:a.alerts,betPageCheck:a.betPageCheck,betBetslipCheck:a.betBetslipCheck,feedbacks:a.feedbacks,betid:a.id,customUrl:a.customUrl}},this.Pc=function(a){for(var c=languages.selected.error_balance,b=0;b<a.alerts.length;b++)if(a.alerts[b].title===c)return a.alerts[b];return!1},this.Kd=function(a){for(var c=languages.selected.error_balance,b=0;b<a.alerts.length;b++)if(a.alerts[b].title===c){a.alerts.splice(b,1);break}},this.jb=function(){for(var a=0;a<arbHandler.currentArb.bets.length;a++)_.isUndefined(arbHandler.currentArb.bets[a].balance)||(arbHandler.currentArb.bets[a].balance<arbHandler.currentArb.bets[a].amount?this.Pc(arbHandler.currentArb.bets[a])||this.ja(languages.selected.error_balance,languages.selected.error_balance,"warning",arbHandler.currentArb.bets[a].id,arbHandler.currentArb.bets[a].bookieName):this.Kd(arbHandler.currentArb.bets[a]))}},w=new function(){this.u=function(a){a+="";var c=a.indexOf(".")+1;return c?a.length-c:0},this.ta=function(a,c){try{if(0==(2&a.notScraped)&&0==(2&c.notScraped)){if(parseFloat(a.oddUp)==parseFloat(c.oddUp)&&parseFloat(a.oddDown)==parseFloat(c.oddDown))return!0}else if(0==(1&a.notScraped)&&0==(1&c.notScraped)){if(parseFloat(a.decimalOdd)==parseFloat(c.decimalOdd))return!0}else if(0==(4&a.notScraped)&&0==(4&c.notScraped)){if(parseFloat(a.usOdd)==parseFloat(c.usOdd))return!0}else if(0==(2&a.notScraped)&&0==(1&c.notScraped)){var b=this.u(c.decimalOdd);if(parseFloat(a.decimalOdd).toFixed(b)==parseFloat(c.decimalOdd))return!0}else if(0==(1&a.notScraped)&&0==(2&c.notScraped)){if(b=this.u(a.decimalOdd),parseFloat(a.decimalOdd)==parseFloat(c.decimalOdd).toFixed(b))return!0}else if(0==(1&a.notScraped)&&0==(4&c.notScraped)){var d=parseFloat(a.decimalOdd),e=parseFloat(c.usOdd);if(0>e){if(b=this.u(d),d==F.P(e).toFixed(b))return!0}else{var g=this.u(d),f=this.u(e/100),b=f>g?g:f;if(d.toFixed(b)==F.P(e).toFixed(b))return!0}}else if(0==(2&a.notScraped)&&0==(4&c.notScraped)){var h=parseFloat(a.oddUp),k=parseFloat(a.oddDown),e=parseFloat(c.usOdd),b=0>e?4:this.u(e/100);if(F.Ga(h,k).toFixed(b)==F.P(e).toFixed(b))return!0}else if(0==(4&a.notScraped)&&0==(1&c.notScraped)){if(d=parseFloat(c.decimalOdd),e=parseFloat(a.usOdd),0>e){if(b=this.u(d),d==F.P(e).toFixed(b))return!0}else if(g=this.u(d),f=this.u(e/100),b=f>g?g:f,d.toFixed(b)==F.P(e).toFixed(b))return!0}else if(0==(4&a.notScraped)&&0==(2&c.notScraped)&&(h=parseFloat(c.oddUp),k=parseFloat(c.oddDown),e=parseFloat(a.usOdd),b=0>e?4:this.u(e/100),F.Ga(h,k).toFixed(b)==F.P(e).toFixed(b)))return!0;return!1}catch(p){return!1}},this.Dc=function(a){if(null==a||null==a.betPage||null==a.betBetslip)return null;for(var c=["player1","player2","handicap","market","leg"],b={},d=0;d<c.length;d++){var e=c[d],g=0;if(null!=a[e]){var f=a[e],h=a.betPage[e],k=a.betBetslip[e],f=this.K(f),h=this.K(h),k=this.K(k);f!=h&&(g|=1),f!=k&&(g|=2)}b[e]=g}return null!=a.pagelink&&a.betPage.pagelink!=a.pagelink&&void 0!==a.betPage.pagelink&&(b.pagelink=1),null!=a.betlink&&a.betPage.betlink!=a.betlink&&void 0!==a.betPage.betlink&&(b.betlink=1),null!=a.kickoff&&(g=0,null!=a.betPage.kickoff&&108e5<Math.abs(parseFloat(a.kickoff)-parseFloat(a.betPage.kickoff))&&(g|=1),null!=a.betBetslip.kickoff&&108e5<Math.abs(parseFloat(a.kickoff)-parseFloat(a.betBetslip.kickoff))&&(g|=2),b.kickoff=g),g=0,0==this.ta(a,a.betPage)&&(g|=1),0==this.ta(a,a.betBetslip)&&(g|=2),0==this.ta(a.betPage,a.betBetslip)&&(g&=2),b.odd=g,b},this.Sc=function(a,c){var e,b=[],d={player1:languages.selected.error_attr_player1,player2:languages.selected.error_attr_player2,handicap:languages.selected.error_attr_handicap,market:languages.selected.error_attr_market,leg:languages.selected.error_attr_leg,kickoff:languages.selected.error_attr_kickoff,odd:languages.selected.error_attr_odd};for(e in d)if(null!=a[e]&&a[e]){var g={title:"Warn"};g.message=languages.selected.error_attrChanged,g.message=g.message.replace("%attr%",d[e]);var f=null;if(1&a[e]?f=c.betPage:2&a[e]&&(f=c.betBetslip),f){var h=null,h="odd"==e?"dec"==c.prefOddFormat?parseFloat(f.decimalOdd).toFixed(2):"frac"==c.prefOddFormat?f.oddUp+"/"+f.oddDown:"us"==c.prefOddFormat?f.usOdd:f.decimalOdd:"kickoff"==e?f[e]:"handicap"==e?f[e]/100:f[e];g.message=h?g.message.replace("%newval%",h.toString()):g.message.replace("%newval%",h)}g.type="warning",("market"==e||"leg"==e||"handicap"==e)&&(g.type="error"),g.key=e,g.value=h,b.push(g)}return b},this.Qc=function(a,c){try{if(null==a)return null;var b={},d=!1;b.betid=c.id;for(var e in a)if(a[e]){var g=null;0!=a[e]&&(d=!0),1&a[e]?g=c.betPage:2&a[e]&&(g=c.betBetslip),g&&("odd"==e?(b.decimalOdd=g.decimalOdd,b.oddUp=g.oddUp,b.oddDown=g.oddDown,b.usOdd=g.usOdd,b.oddFormat=g.oddFormat,b.notScraped=g.notScraped):b[e]=g[e])}return d?b:null}catch(f){return null}},this.Cc=function(a,c){for(var b=["player1","player2","handicap","market","leg"],d=0;d<b.length;d++){var e=a[b[d]],g=c[b[d]],e=this.K(e),g=this.K(g);if(e!==g)return!1}return 0==this.ta(a,c)?!1:!0},this.K=function(a){return"string"==typeof a&&(a=a.toUpperCase().normalize("NFC")),a},this.mb=function(a){return a.match(/^[a-zA-Z]+:\/\//)||(a="http://"+a),a}},t=new function(){this.G=null,this.ob=this.tb="",this.R=!0,this.ea=null,this.oa=[],this.Ka=function(){t.G=document.implementation.createHTMLDocument("example"),t.G.documentElement.innerHTML=scriptLoader.scripts["resources/sidebar.html"],t.tb=scriptLoader.scripts["resources/devTemplate.html"],t.ob=scriptLoader.scripts["resources/clientTemplate.html"],C.Zc(function(a){t.ea=a})},this.zc=function(){var a=t.G.getElementById("contentBody");a&&(a.innerHTML="")},this.v={displaySiteOddFormat:function(a){if(null===a.betPage||void 0===a.betPage||null===a.betPage.oddFormat||null===a.prefOddFormat)return null;if(a.prefOddFormat!==a.betPage.oddFormat){if("dec"===a.betPage.oddFormat)return parseFloat(a.betPage.decimalOdd).toFixed(2);if("frac"===a.betPage.oddFormat)return a.betPage.oddUp+"/"+a.betPage.oddDown;if("us"===a.betPage.oddFormat)return a.betPage.usOdd}return null},displayPrefOddFormat:function(a){return null==a.prefOddFormat||void 0==a.prefOddFormat?null:"dec"==a.prefOddFormat?parseFloat(a.decimalOdd).toFixed(2):"frac"==a.betPage.oddFormat?a.oddUp+"/"+a.oddDown:"us"==a.betPage.oddFormat?F.pa(a.decimalOdd).toFixed(2):null},progressType:function(){return function(a,c){var b=c(a);return"error"==b?"danger":b}},alertIcon:function(){return function(a,c){var b=c(a);return"warning"==b?"icon-warning-sign":"error"==b?"icon-remove":"cus-exclamation"}},formatAlertMessage:function(){return function(a,c){var b=c(a),b=b.replace(/&#x2F;/g,"/"),d=b.match("{{#date}}([0-9]+){{/date}}");if(d)var e=c('{{#formatDateTime}}{"date": "'+d[1]+'", "format": "{{lang.dateTimeFormat}}"}{{/formatDateTime}}'),b=b.replace(d[0],e);return b}},formatDateTime:function(){return function(a,c){var b=c(a);try{var d=JSON.parse(b);return moment(parseFloat(d.date)).format(d.format)}catch(e){}return b}},roundToFixed:function(){return function(a,c){var b=c(a);try{var d=JSON.parse(b);return parseFloat(d.value).toFixed(d.decimals)}catch(e){}return b}},Hb:function(){return function(a,c){var b=c(a);return 0>parseFloat(b)?"betFinderEarningAmountNegative":""}},getKickoffTimeDate:function(a,c,b){return b=moment(b).toISOString(),moment(b).zone(-1*a.slice(3)).format(c)+" "+a}},this.Jc=function(a){var c=t.ob;if(a.lang=languages.selected,null==u.k){null==a.arbAlerts&&(a.arbAlerts=[]);for(var b=!1,d=0;d<a.arbAlerts.length;d++)a.arbAlerts[d].noHomeSite&&(b=!0);b||a.arbAlerts.push({noHomeSite:!0})}if(a.arb){for(a.arb.active=!1,d=0;d<a.bets.length;d++)a.bets[d].displaySiteOddFormat=t.v.displaySiteOddFormat(a.bets[d]),a.bets[d].displayPrefOddFormat=t.v.displayPrefOddFormat(a.bets[d]),a.bets[d].progress&&(a.bets[d].progress.typeText=t.v.progressType);a.formatDateTime=t.v.formatDateTime,a.progressType=t.v.progressType,a.alertIcon=t.v.alertIcon,a.formatAlertMessage=t.v.formatAlertMessage,a.roundToFixed=t.v.roundToFixed,a.Hb=t.v.Hb,_.isUndefined(a.timezone)||(a.arbAssumedKickoff=t.v.getKickoffTimeDate(a.timezone,a.lang.dateTimeFormat,a.arb.assumedKickoff)),a.arb.arbType=2<a.arb.bestPercentage?"success":"warning",1==a.arb.devView&&(c=t.tb)}a=Mustache.render(c,a),t.G&&(t.G.getElementById("contentBody").innerHTML=a)},this.Ma=function(a,c){if(a.match(scriptLoader.scriptList.homeSitePattern))return c&&c(!0),!0;if(t.ea){var b=new URL(a).hostname,d=null;return 0<t.oa.length&&(d=_.findIndex(t.oa,function(a){return 0<=b.indexOf(a)?!0:!1})),(null==d||-1===d)&&(d=_.findIndex(t.ea,function(a){return 0<=b.indexOf(a)?!0:!1})),d=d>=0,c&&c(d),d}return u.n("getSidebarSites",{}),c&&c(!1),!1},this.dc=function(){D.da({action:"contentUpdated"})},this.Vc=function(){return t.G.getElementById("sidebarContent").innerHTML},this.Wc=function(){return t.G.getElementById("footerscripts").innerHTML},this.Ia=function(){return C.Ia()},this.Ra=function(){},this.pb=function(a){C.Bc(a)},this.Xa=function(a){C.Xa(a)},this.ia=function(){C.ia(u.k)},this.Fa=function(){C.Fa()}};t.za=new function(){this.tour={$:!1,step:0,tourObj:tours.en_gb},this.Zd=function(){this.tour.$=!0,this.tour.step=0},this.aa=function(a){if(this.tour.$&&-1!=["newArb","updateArb","closeArb"].indexOf(a)){this.tour.tourObj.steps[this.tour.step].nextOnMessage==a&&this.b("next");for(var c=this.tour.tourObj.events,b=0;b<c.length;b++){var d=c[b];d.event==a&&"goBackToStep"==d.action&&this.tour.step>d.args[0]&&(this.tour.step=d.args[0])}}},this.b=function(a){"start"!=a&&("close"==a?(this.tour.$=!1,this.tour.step=0):"end"==a?(this.tour.$=!1,this.tour.step=0):"next"==a?this.tour.step+1<this.tour.tourObj.steps.length&&(this.tour.step++,this.tour.tourObj.steps[this.tour.step].skipStep&&this.tour.tourObj.steps[this.tour.step].skipStep()&&this.tour.step+1<this.tour.tourObj.steps.length&&this.tour.step++):"prev"==a&&0<this.tour.step&&this.tour.step--)}},t.Ka();